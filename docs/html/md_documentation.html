<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Battleships: Documentation</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Battleships
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Documentation </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><ol type="1">
<li><b>Game</b></li>
<li><b>Matchmaking</b></li>
<li><b><a class="el" href="namespaceClient.html">Client</a></b></li>
<li><b><a class="el" href="namespaceServer.html">Server</a></b></li>
<li><b>UI/UX</b></li>
<li><b>BDD</b></li>
</ol>
<h1><a class="anchor" id="autotoc_md21"></a>
1.  Game</h1>
<h3><a class="anchor" id="autotoc_md22"></a>
Typical game</h3>
<p>Game is turn-based Each player has to place his pieces onto his side of the map Once ships are placed, each player will have to choose a cell from its opponent grid. Either if a ship is touched or not, the player is noticed When a ship is sunk, the player is also noticed One player wins when every ship on its opponent side has been sunk</p>
<h1><a class="anchor" id="autotoc_md23"></a>
3. Server</h1>
<p>The server will receive socket information containing both a header for server-side interpretation for the data and the actual data.</p>
<p>A handler will have to give the data to the <code>Game</code> instance</p>
<p>Example of data to be sent (clients would have to send its list of ships, or a target hit) </p><div class="fragment"><div class="line">ship_cells = [{<span class="stringliteral">&quot;_pos&quot;</span>: {<span class="stringliteral">&quot;_x&quot;</span>: 0, <span class="stringliteral">&quot;_y&quot;</span>: 1}}, {<span class="stringliteral">&quot;_pos&quot;</span>: {<span class="stringliteral">&quot;_x&quot;</span>: 0, <span class="stringliteral">&quot;_y&quot;</span>: 1}}, {<span class="stringliteral">&quot;_pos&quot;</span>: {<span class="stringliteral">&quot;_x&quot;</span>: 0, <span class="stringliteral">&quot;_y&quot;</span>: 1}}]</div>
<div class="line"> </div>
<div class="line">data = {<span class="stringliteral">&quot;_ships&quot;</span>: [{<span class="stringliteral">&quot;_size&quot;</span>: 3, <span class="stringliteral">&quot;_pos&quot;</span>: {<span class="stringliteral">&quot;_x&quot;</span>: 0, <span class="stringliteral">&quot;_y&quot;</span>: 1,},  <span class="stringliteral">&quot;_ship_cells&quot;</span>: ship_cells}]}</div>
</div><!-- fragment --><p>A request <b>MUST</b> contain the type of the request and its sub-request, otherwise it will be discarded. </p><div class="fragment"><div class="line">{</div>
<div class="line">    &quot;request&quot;: [&quot;GAME&quot;, &quot;HIT&quot;],</div>
<div class="line">    &quot;client_id&quot;: 12,</div>
<div class="line">    &quot;game_id&quot;: 34,</div>
<div class="line">    &quot;data&quot;: {&quot;_x&quot;: 1, &quot;_y&quot;: 0}</div>
<div class="line">}</div>
</div><!-- fragment --><h4><a class="anchor" id="autotoc_md24"></a>
Requests:</h4>
<ul>
<li><code>GAME</code> this will inform the server your request is about an in-progress game.</li>
<li><code>MATCHMAKING</code> this will inform the server your request is about the pregame matchmaking system.</li>
</ul>
<h4><a class="anchor" id="autotoc_md25"></a>
Sub-requests:</h4>
<ul>
<li><code>HIT</code> to inform the server that you want to try a hit at (<code>x</code>,<code>y</code>)</li>
<li><code>QUEUE_IN</code> to inform the server that you are willing to join the matchmaking queue</li>
<li><code>QUEUE_OUT</code> to inform the server that you are willing to leave the matchmaking queue</li>
<li><code>MESSAGE</code> to send a message to the other client</li>
</ul>
<p>This is best explained in the <code>Class Hierarchy</code> page</p>
<p><code>WholeGameData</code>: The whole data that happened during the game, each turn is recorded and store from the beginning to the end of the game in the server.</p>
<h3><a class="anchor" id="autotoc_md26"></a>
/!\ Important point</h3>
<p>How are we going to handle a disconnected client when an opponent make a turn?</p>
<p><a class="anchor" id="autotoc_md27"></a> </p><h5>Possible solution</h5>
<p>When in a <code>pair</code>, one of the clients has lost connection to the server and is willing to reconnect to the game, the client will have to notice this event to the application to be prepared of receiving the <code>WholeGameData</code>. That will allow us to recreate the game at the point it actually is, even for turns that could be made after the <code>client</code> was disconnected.</p>
<p>Server-side, it shall scan for whether new incoming socket connection was previously linked to another <code>client</code> as a <code>pair</code>. If so, we set to this <code>client</code> inside of the <code>pair</code> the previous disconnected one and send after the pairing the <code>WholeGameData</code> to this client.</p>
<p>As for now, this is yet not implemented. If a client connection is closed the game will just be frozen to its state.</p>
<h4><a class="anchor" id="autotoc_md28"></a>
What is a &lt;tt&gt;Pair&lt;/tt&gt; to the server?</h4>
<p>A <code>pair</code> is a set of two clients connections, that are currently linked by the server for post-matchmaking communication (either messaging or game-related events):</p>
<ul>
<li>The current <code>Game</code> instance to process the game and keep a track of its different states.</li>
<li>An <code>id</code> that will be the game id</li>
<li>A First <code><a class="el" href="namespaceClient.html">Client</a></code></li>
<li>A Second <code><a class="el" href="namespaceClient.html">Client</a></code></li>
</ul>
<h3><a class="anchor" id="autotoc_md29"></a>
Bad data</h3>
<p>Bad data can happen as sockets could not send or receive properly the transmitted data. But there could be few cases in which a user would try breaking the behavior of the game and send data when it is not his turn, simulating an opponent attack</p>
<p>To prevent that, we could possibly make an end and cancel any game receiving that kind of suspicious sent packets from one of its clients. We also could simply discard any data sent from clients attempting a request to a game they do not belong in.</p>
<p>An ideal approach would be to blacklist every IP trying to perform too much illegal requests in a span of time, but it could also be some huge amount of work to get it as intended. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
